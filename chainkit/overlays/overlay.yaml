overlay: 1.0.0
info:
  title: Overlay to change the merged OpenAPI Spec 
  version: 1.0.0
actions:
  - target: $["paths"]["/v1/chains"]["get"][?(@['servers'][0]['url'] == 'https://glacier-api.avax.network')]["responses"]["200"]["content"]["application/json"]["schema"]
    description: Change the response schema for the /v1/chains endpoint in glacier to avoid a merger conflict with Popsicle API Spec
    update:
      $ref: "#/components/schemas/DataListChainsResponse"
    
  - target: $["paths"]["/v2/chains"]["get"][?(@['servers'][0]['url'] == 'https://popsicle-api.avax.network' || @['servers'][0]['url'] == 'https://metrics.avax.network')]["responses"]["200"]["content"]["application/json"]["schema"]
    description: Change the response schema for the /v2/chains endpoint in popsicle to avoid a merger conflict with Popsicle API Spec
    update:
      $ref: "#/components/schemas/MetricsListChainsResponse"
    
  - target: $["components"]["schemas"]["ListChainsResponse"]
    description: Remove the unused schema
    remove: true
  
  - target: $.info
    description: Add a description to the OpenAPI spec
    update:
      description: The Avalanche API suite offers powerful tools for real-time and historical blockchain data. The Webhooks API enables instant monitoring of on-chain events, including smart contract activity, NFT transfers, and wallet transactions, with customizable filters and secure notifications. The Metrics API (Beta) provides analytics on blockchain activity, while the Data API (Beta) delivers multi-chain data for Avalanche and Ethereum, including transaction history, token balances, and metadata. These APIs empower developers to build dynamic web3 applications with real-time insights and seamless integration.
      title: Data, Metrics, and Webhooks API

  - target: $.paths['/v1/webhooks'].post
    description: Keep the /v1/webhooks POST endpoint in usage example of root readme
    update:
      x-speakeasy-usage-example: true

  - target: $.paths['/v1/avax/supply'].get
    description: Rename the method name for /v1/avax/supply GET endpoint
    update:
      x-speakeasy-name-override: get

  - target: $.paths.*.*[?(@['tags'][0] == 'Notifications')]
    description: Remove all paths that are tagged with 'notifications' if they somehow exist
    update:
      x-speakeasy-ignore: true
  
  - target: $.paths.*.*[?(@.deprecated == true && (@['servers'][0]['url'] == 'https://popsicle-api.avax.network' || @['servers'][0]['url'] == 'https://metrics.avax.network'))]
    description: Remove all deprecated paths
    update:
      x-speakeasy-ignore: true

  - target: $.paths['/v2/lookingGlass/compositeQuery']
    description: Remove the /v2/lookingGlass/compositeQuery path
    update:
      x-speakeasy-ignore: true

  - target: $.paths['/v1/lookingGlass/compositeQuery']
    description: Remove the /v1/lookingGlass/compositeQuery path
    update:
      x-speakeasy-ignore: true

  - target: $
    description: Add a servers list to the OpenAPI spec
    update:
      servers:
        - url: https://glacier-api.avax.network
          description: Data API
